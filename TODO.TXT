что уже сделано:
 - фикс primary stream display fetch по возврату из VESA 320x2?0 8bpp
   (для trio64v2+ с vbe2.0 видеобиосом, инфу брать из savage4 datasheet)
   (простой пример бага - грузим quake, ставим режим 320x240, ставим любой
   с шириной 360 пикселов -> правая часть экрана черная, по возврату в DOS - 
   мусор в текстовом режиме в правой чсти экрана)
   >>работает збс! заодно пофиксил другой баг - полный ПИЗДЕЦ вместо 360x???
   >>на trio3d из-за постоянно работающего fifo fetch с кривыми параметрами
 - поддержка VESA 320x[400\480] 8\15\16\32bpp режимов [берем VESA 320x[200\240]
   и отрубаем doublescan + фикс vesa mode info block]
   >>прикостылил чуток, но заработало (да еще как!)
 - переопределение объема установленной памяти + фикс кол-ва видеостраниц
   >>вроде работает, но есть проблемы - vbetest трапается на скроллинге, демы
   >>иногда игнорят и колбасятся. зато теперь duke3d в 1024x768 пашет :p
 - принудительные настройки для set display start ждать\не ждать ретрейса
   >>арбайтен. даже bring it back \ calodox (bibf.exe, 64k) зафиксилась
   >>(ну там еще есть подергивания, но насрать - глитчи всегда в тему ;)
 - бустер для VESA banked режимов (как в s3speedup, только не требуются еще
   резиденты для работы) [тырим из svgatrix.txt алгоритм либо курим даташиты
   и делаем по ним + переписать функцию 4F05 (vesa bank get\set), ибо S3-шная
   с бустером не дружит + обязательно не допускаем конфликтов с LFB!]
   (вероятно не будет работать на savage4+, но фиг с ним :)
   >>в общем, впилил. работает вообще збс, после фикса функции 4F05 пашет ВСЕ!

список всего того дерьма, которое нужно сделать:

 - установка гаммы(?) нормально\повышенно (пример - старые [vbe1.2 only] биосы
   от v2dx и некоторые от virgedx\trio3d ставят повышенную гамму -> темно-серый
   цвет вместо черного)
   для trio3d+ - установка гаммы в доступном для чипа диапазоне (но блеать на
   trio3d датаshitов нигде нет, так что как делать на них - хз [savage4 - ОК])
   >>короче, какой диапазон гаммы у trio3d, я не знаю, но ТОТ САМЫЙ баг с
   >>повышенной гаммой на ней тоже фиксится, но через другой регистр (у v2dx\
   >>virgedx - 0x3C4 index 1A bit 5, у trio3d\savage - 0x3C4 index 27 bit 3)
 - режим 320x200 _24bpp_ (3 байта на пиксел) на до-trio3d картах (для кривых
   демок\интр которые в 32bpp не могут\не хотят [руки оторвать кодерам! :) ]
   320x240 и выше в 24bpp делать смысла нет ибо нефиг поощрять говнокодеров
   >>так как раздобыл pci-ную trio3d2d, которая из коробки умеет 24bpp во всех
   >>разрешениях, есть 80% вероятность, что эту хрень пилить я не буду
 - переопределение разрядности RAMDAC в 8-битных режимах (ну как в 6bitdac.com)
   >>говорят типа flight unlimited на картах с палитрой 8 бит на канал глючит
   >>А ВОТ ХУЙ! на матроксе все пахало отлично без всяких там резидентов. как
   >>откопаю компакт с игрухой, гляну на trio3d, вылезут баги - запилю фикс.
 - добавить детекты карточек
   >>когда-нибудь, скорее всего на следующей неделе (как напишу первый экзамен)
 - в конце-то концов, написать НОРМАЛЬНУЮ документацию!
   >>аналогично

/* фкомменты, ибо нефиг
что нужно патчить:
 - vesa controller info block - указатель на список режимов, может еще что-то
 - список режимов - я хз где его разместить - можно засунуть в тело резидента;
   нужно добавить наши новые режимы внутрь (лучше всего в конец списка)
 - vesa mode info block - всякие параметры + указатель на vesa bank set\get
   если заюзан бустер + еще что-либо нужное)
 - параметры развертки для 320x200 24bpp - ну это само собой разумеющееся :)
*/

убрано нафиг:
 - фикс set display start - в duke nukem 3d мерцает левый нижний край экрана в
   разрешениях, где доступны 2 видеостраницы - таки баг дюка, на матроксе в
   1024x768 даже хуже чем на S3.
   с другой стороны, 1024x768 - недокументированный режим ;)
   возможно зафикшу 64к от calodox (bibf.exe), на S3 в 512x384 колбасит page
   flipping (univbe либо 640x480 - ОК, на матроксе тоже без проблем)
   >>короче пофиксил малой кровью. "и так сойдет" :D

прочие фиксы также возможны, но мне лень :D
--wbcbz7 28.o5.2o16
   